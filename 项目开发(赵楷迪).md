# 🔺✨ Day one

## (一)  实现对话框保存用户数据传至App数组

需求: 点击Main增加接口按钮时，弹出对话框， 用户输入数据后将数据保存至对应的数组

**思路：** 

1. 在mainUse文件夹中的diaLog组件 使用 element组件对话框
2. 在Main父组件中点击按钮后定义方法， 将Visble布尔值改为true并传入diaLog组件
3. 组件显示后, 弹出对应对话框后，用户输入确定后将数据利用事件总线    emit 事件
4. App.vue根组件中 on 事件  并将对象 使用展开运算符赋值对象， 并将push保存至数组



### 1. diaLog组件使用对话框

在对话框中使用form标签， 为需要填写或选择的表单  （见文件- MainUse - dialog.vue

```ts
<el-dialog
      title="增加接口"
      :visible.sync="dialogVisible"
      width="25%"
      :showClose="false"
    >
      <el-form :model="form" label-width="80px" ref="form">
        <el-form-item label="ID:" prop="id" :rules="rules.id">
          <el-input v-model="form.id"></el-input>
        </el-form-item>

        <el-form-item label="Name:" prop="name" :rules="rules.name">
          <el-input v-model="form.name"></el-input>
        </el-form-item>

        <el-form-item label="API:" prop="api" :rules="rules.api">
          <el-input v-model="form.api"></el-input>
        </el-form-item>

        <el-form-item label="Done:" prop="done" :rules="rules.done">
          <el-select v-model="form.done" placeholder="请选择">
            <el-option label="true" value="true"></el-option>
            <el-option label="false" value="false"></el-option>
          </el-select>
        </el-form-item>

        <el-form-item label="Method:" prop="method" :rules="rules.method">
          <el-select
            v-model="form.method"
            placeholder="请选择"
            class="custom-select"
          >
            <el-option label="GET" value="GET"></el-option>
            <el-option label="POST" value="POST"></el-option>
          </el-select>
        </el-form-item>
      </el-form>
      <span slot="footer" class="dialog-footer">
        <el-button
          type="danger"
          @click="dialogVisible = false"
          class="custom-select"
          >取 消</el-button
        >
        <el-button type="primary" @click="uploadForm">确 定</el-button>
      </span>
    </el-dialog>
```



#### 1.1  diaLog组件中 form 规则的设置

```ts
      rules: {
        id: [{ required: true, message: "请输入ID", trigger: "blur" }],
        name: [{ required: true, message: "请输入Name", trigger: "blur" }],
        api: [{ required: true, message: "请输入API", trigger: "blur" }],
        done: [{ required: true, message: "请选择Done", trigger: "change" }],
        method: [
          { required: true, message: "请选择Method", trigger: "change" },
        ],
      },
```



#### 1.2  使用bus总线emit 事件， 将表格数据传出

**bus总线已定义在 Bus文件夹内**

```ts
methods: {
    uploadForm() {
      this.dialogVisible = false;

      Bus.$emit("uploadForm", this.form);
    },
  },
```



### 2. 父组件- Main引入组件dia-Log

为新增接口绑定事件， 并ref绑定dia-Log实例， 当点击按钮式， 将对话框显示， 并在数据触发后， 对表单进行一个数据清空

```ts
<button @click="openDialog">新增接口</button>
<dia-log ref="diaLogRef"></dia-log>

methods: {
openDialog() {
const LogRef = this.$refs.diaLogRef;
LogRef.dialogVisible = true;

// 并在每次点击清空上次的表格填写内容
Object.keys(LogRef.form).forEach((item) => {
LogRef.form[item] = "";
});
},
```



### 3. App 使用事件总线，on事件并将对象数据push数组

当使用引用传递时， 在下一个的新增接口，会对之前的数据影响

所以需要使用：**展开运算符转换为 值传递**

```ts
 created() {
    // 监听自定义事件，并处理传递的数据
    Bus.$on("uploadForm", (formData) => {
      const copiedForm = { ...formData }; // 使用展开运算符创建一个新的对象副本
      this.testArr.push(copiedForm);
    });
  },
};
```



## （二） 其它修改

主要对浏览器缩小进行了修改， 因为缩小时换行，导致整行数据换行 混合一起

- 主要对样式进行处理， 溢出处理

```ts
  /* 此部分暂时解决 缩小时, 文本溢出换行 */
  white-space: nowrap; /* 防止换行 */
  overflow: hidden; /* 超出部分隐藏 */
  text-overflow: ellipsis; /* 超出部分显示省略号 */
```



样式调整后， 在浏览器缩小还是会出现对不齐的情况



## 💓🐟 bug记录

解决过程： 

**问题：**

- bus总线 有毛病： 
  每次的监听都为独立的事件
  	每次的点击都会影响上次的数据
- 如果解绑时却会导致只能监听触发一次



💓🐟 ：传递的时候引用传递， 应该使用值传递



### 未解决 - 预解决的bug -- 

未解决：  

1. Main中对应 文本 样式的调整    (对齐 )
2. diaLog样式的调整，（样式好丑）， select的宽度与输入框不一致， 弹出对话框样式解决不了， 原想设置整体透明度为70%， 四角为弧度~ 
3. 规则的rules应用， 原先想设置对话框的确定键需用户通过验证才可点击确定， 想通过ref获取Log组件事件，去进行验证，但是行不通... 

